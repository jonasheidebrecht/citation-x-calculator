<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Citation X Landing Distance Interpolator (15° Flaps)</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; }
    input, select { margin: 4px; }
    .result { margin-top: 20px; font-size: 1.2em; color: #003366; }
  </style>
</head>
<body>
  <h2>Citation X Landing Distance (15° Flaps) Interpolator</h2>
  <form id="interpForm">
    <label>Elevation (ft): <input type="number" id="elevation" value="0" min="0" max="8000" step="1"></label>
    <label>Temperature (°C): <input type="number" id="temp" value="15"></label>
    <label>Landing Weight (lb): <input type="number" id="weight" value="25000" min="25000" max="31800"></label>
    <button type="submit">Interpolate</button>
  </form>
  <div class="result" id="result"></div>
  <script>
    // Citation X Landing Distance Data (15° Flaps, Dry Runway)
    // Elevation (ft) -> Temp (°C) -> Weight (lb) -> Distance (ft)
    // Only a representative sample is shown; fill in all values for full accuracy.
    const landingData = {
      0: {
        "-20": {31800: 2860, 31000: 2790, 29000: 2650, 27000: 2540, 25000: 2440},
        "-10": {31800: 2900, 31000: 2830, 29000: 2690, 27000: 2580, 25000: 2480},
        "0":   {31800: 2940, 31000: 2870, 29000: 2730, 27000: 2620, 25000: 2520},
        "10":  {31800: 2980, 31000: 2910, 29000: 2770, 27000: 2660, 25000: 2560},
        "15":  {31800: 2990, 31000: 2920, 29000: 2780, 27000: 2670, 25000: 2990},
        "20":  {31800: 3010, 31000: 2940, 29000: 2800, 27000: 2690, 25000: 3010},
        "25":  {31800: 3030, 31000: 2960, 29000: 2820, 27000: 2710, 25000: 3030},
        "30":  {31800: 3050, 31000: 2980, 29000: 2840, 27000: 2730, 25000: 3050}
      },
      1000: {
        "-20": {31800: 2910, 31000: 2840, 29000: 2700, 27000: 2590, 25000: 2490},
        "-10": {31800: 2950, 31000: 2880, 29000: 2740, 27000: 2630, 25000: 2530},
        "0":   {31800: 2990, 31000: 2920, 29000: 2780, 27000: 2670, 25000: 2570},
        "10":  {31800: 3030, 31000: 2960, 29000: 2820, 27000: 2710, 25000: 2610},
        "15":  {31800: 3040, 31000: 2970, 29000: 2830, 27000: 2720, 25000: 3040},
        "20":  {31800: 3060, 31000: 2990, 29000: 2850, 27000: 2740, 25000: 3060},
        "25":  {31800: 3080, 31000: 3010, 29000: 2870, 27000: 2760, 25000: 3080},
        "30":  {31800: 3100, 31000: 3030, 29000: 2890, 27000: 2780, 25000: 3100}
      },
      2000: {
        "-20": {31800: 2960, 31000: 2890, 29000: 2750, 27000: 2640, 25000: 2540},
        "-10": {31800: 3000, 31000: 2930, 29000: 2790, 27000: 2680, 25000: 2580},
        "0":   {31800: 3040, 31000: 2970, 29000: 2830, 27000: 2720, 25000: 2620},
        "10":  {31800: 3080, 31000: 3010, 29000: 2870, 27000: 2760, 25000: 2660},
        "15":  {31800: 3090, 31000: 3020, 29000: 2880, 27000: 2770, 25000: 3090},
        "20":  {31800: 3110, 31000: 3040, 29000: 2900, 27000: 2790, 25000: 3110},
        "25":  {31800: 3130, 31000: 3060, 29000: 2920, 27000: 2810, 25000: 3130},
        "30":  {31800: 3150, 31000: 3080, 29000: 2940, 27000: 2830, 25000: 3150}
      },
      3000: {
        "-20": {31800: 3010, 31000: 2940, 29000: 2800, 27000: 2690, 25000: 2590},
        "-10": {31800: 3050, 31000: 2980, 29000: 2840, 27000: 2730, 25000: 2630},
        "0":   {31800: 3090, 31000: 3020, 29000: 2880, 27000: 2770, 25000: 2670},
        "10":  {31800: 3130, 31000: 3060, 29000: 2920, 27000: 2810, 25000: 2710},
        "15":  {31800: 3140, 31000: 3070, 29000: 2930, 27000: 2820, 25000: 3140},
        "20":  {31800: 3160, 31000: 3090, 29000: 2950, 27000: 2840, 25000: 3160},
        "25":  {31800: 3180, 31000: 3110, 29000: 2970, 27000: 2860, 25000: 3180},
        "30":  {31800: 3200, 31000: 3130, 29000: 2990, 27000: 2880, 25000: 3200}
      },
      4000: {
        "-20": {31800: 3060, 31000: 2990, 29000: 2850, 27000: 2740, 25000: 2640},
        "-10": {31800: 3100, 31000: 3030, 29000: 2890, 27000: 2780, 25000: 2680},
        "0":   {31800: 3140, 31000: 3070, 29000: 2930, 27000: 2820, 25000: 2720},
        "10":  {31800: 3180, 31000: 3110, 29000: 2970, 27000: 2860, 25000: 2760},
        "15":  {31800: 3190, 31000: 3120, 29000: 2980, 27000: 2870, 25000: 3190},
        "20":  {31800: 3210, 31000: 3140, 29000: 3000, 27000: 2890, 25000: 3210},
        "25":  {31800: 3230, 31000: 3160, 29000: 3020, 27000: 2910, 25000: 3230},
        "30":  {31800: 3250, 31000: 3180, 29000: 3040, 27000: 2930, 25000: 3250}
      },
      5000: {
        "-20": {31800: 3110, 31000: 3040, 29000: 2900, 27000: 2790, 25000: 2690},
        "-10": {31800: 3150, 31000: 3080, 29000: 2940, 27000: 2830, 25000: 2730},
        "0":   {31800: 3190, 31000: 3120, 29000: 2980, 27000: 2870, 25000: 2770},
        "10":  {31800: 3230, 31000: 3160, 29000: 3020, 27000: 2910, 25000: 2810},
        "15":  {31800: 3240, 31000: 3170, 29000: 3030, 27000: 2920, 25000: 3240},
        "20":  {31800: 3260, 31000: 3190, 29000: 3050, 27000: 2940, 25000: 3260},
        "25":  {31800: 3280, 31000: 3210, 29000: 3070, 27000: 2960, 25000: 3280},
        "30":  {31800: 3300, 31000: 3230, 29000: 3090, 27000: 2980, 25000: 3300}
      },
      6000: {
        "-20": {31800: 3160, 31000: 3090, 29000: 2950, 27000: 2840, 25000: 2740},
        "-10": {31800: 3200, 31000: 3130, 29000: 2990, 27000: 2880, 25000: 2780},
        "0":   {31800: 3240, 31000: 3170, 29000: 3030, 27000: 2920, 25000: 2820},
        "10":  {31800: 3280, 31000: 3210, 29000: 3070, 27000: 2960, 25000: 2860},
        "15":  {31800: 3290, 31000: 3220, 29000: 3080, 27000: 2970, 25000: 3290},
        "20":  {31800: 3310, 31000: 3240, 29000: 3100, 27000: 2990, 25000: 3310},
        "25":  {31800: 3330, 31000: 3260, 29000: 3120, 27000: 3010, 25000: 3330},
        "30":  {31800: 3350, 31000: 3280, 29000: 3140, 27000: 3030, 25000: 3350}
      },
      7000: {
        "-20": {31800: 3210, 31000: 3140, 29000: 3000, 27000: 2890, 25000: 2790},
        "-10": {31800: 3250, 31000: 3180, 29000: 3040, 27000: 2930, 25000: 2830},
        "0":   {31800: 3290, 31000: 3220, 29000: 3080, 27000: 2970, 25000: 2870},
        "10":  {31800: 3330, 31000: 3260, 29000: 3120, 27000: 3010, 25000: 2910},
        "15":  {31800: 3340, 31000: 3270, 29000: 3130, 27000: 3020, 25000: 3340},
        "20":  {31800: 3360, 31000: 3290, 29000: 3150, 27000: 3040, 25000: 3360},
        "25":  {31800: 3380, 31000: 3310, 29000: 3170, 27000: 3060, 25000: 3380},
        "30":  {31800: 3400, 31000: 3330, 29000: 3190, 27000: 3080, 25000: 3400}
      },
      8000: {
        "-20": {31800: 3260, 31000: 3190, 29000: 3050, 27000: 2940, 25000: 2840},
        "-10": {31800: 3300, 31000: 3230, 29000: 3090, 27000: 2980, 25000: 2880},
        "0":   {31800: 3340, 31000: 3270, 29000: 3130, 27000: 3020, 25000: 2920},
        "10":  {31800: 3380, 31000: 3310, 29000: 3170, 27000: 3060, 25000: 2960},
        "15":  {31800: 3390, 31000: 3320, 29000: 3180, 27000: 3070, 25000: 3390},
        "20":  {31800: 3410, 31000: 3340, 29000: 3200, 27000: 3090, 25000: 3410},
        "25":  {31800: 3430, 31000: 3360, 29000: 3220, 27000: 3110, 25000: 3430},
        "30":  {31800: 3450, 31000: 3380, 29000: 3240, 27000: 3130, 25000: 3450}
      }
    };

    // Helper: Find bracketing values
    function bracket(arr, val) {
      arr = arr.map(Number).sort((a, b) => a - b);
      if (val <= arr[0]) return [arr[0], arr[0]];
      if (val >= arr[arr.length - 1]) return [arr[arr.length - 1], arr[arr.length - 1]];
      for (let i = 0; i < arr.length - 1; i++) {
        if (val >= arr[i] && val <= arr[i + 1]) return [arr[i], arr[i + 1]];
      }
    }

    // Tri-linear interpolation
    function interpolate(elev, temp, weight) {
      const elevs = Object.keys(landingData).map(Number);
      const [e0, e1] = bracket(elevs, elev);

      function getTemps(e) { return Object.keys(landingData[e]).map(Number); }
      const [t0, t1] = bracket(getTemps(e0), temp);
      const [t2, t3] = bracket(getTemps(e1), temp);

      function getWeights(e, t) { return Object.keys(landingData[e][t]).map(Number); }
      function getVal(e, t, w) {
        const weights = getWeights(e, t);
        const [w0, w1] = bracket(weights, w);
        const v0 = landingData[e][t][w0];
        const v1 = landingData[e][t][w1];
        return w0 === w1 ? v0 : v0 + (v1 - v0) * (w - w0) / (w1 - w0);
      }
      function interp2(x0, x1, y0, y1, x) {
        return x0 === x1 ? y0 : y0 + (y1 - y0) * (x - x0) / (x1 - x0);
      }
      // Interpolate in temp for each elevation
      const f_e0 = interp2(t0, t1, getVal(e0, t0, weight), getVal(e0, t1, weight), temp);
      const f_e1 = interp2(t2, t3, getVal(e1, t2, weight), getVal(e1, t3, weight), temp);
      // Interpolate in elevation
      return interp2(e0, e1, f_e0, f_e1, elev);
    }

    document.getElementById('interpForm').addEventListener('submit', function(e){
      e.preventDefault();
      const elev = parseFloat(document.getElementById('elevation').value);
      const temp = parseFloat(document.getElementById('temp').value);
      const weight = parseFloat(document.getElementById('weight').value);

      const elevs = Object.keys(landingData).map(Number);
      const [e0, e1] = bracket(elevs, elev);

      if (elev < Math.min(...elevs) || elev > Math.max(...elevs)) {
        document.getElementById('result').textContent = "Elevation out of data range.";
        return;
      }

      function getTemps(e) { return Object.keys(landingData[e]).map(Number); }
      const temps0 = getTemps(e0), temps1 = getTemps(e1);
      if (temp < Math.min(...temps0, ...temps1) || temp > Math.max(...temps0, ...temps1)) {
        document.getElementById('result').textContent = "Temperature out of data range for this elevation.";
        return;
      }

      function getWeights(e, t) { return Object.keys(landingData[e][t]).map(Number); }
      const [t0, t1] = bracket(getTemps(e0), temp);
      const [t2, t3] = bracket(getTemps(e1), temp);
      const ws00 = getWeights(e0, t0), ws01 = getWeights(e0, t1);
      const ws10 = getWeights(e1, t2), ws11 = getWeights(e1, t3);
      const minW = Math.min(...ws00, ...ws01, ...ws10, ...ws11);
      const maxW = Math.max(...ws00, ...ws01, ...ws10, ...ws11);
      if (weight < minW || weight > maxW) {
        document.getElementById('result').textContent = "Weight out of data range.";
        return;
      }

      const fieldLen = interpolate(elev, temp, weight);
      document.getElementById('result').innerHTML = `<b>Estimated Landing Distance:</b> <span style="color:darkgreen">${fieldLen.toFixed(0)} ft</span>`;
    });
  </script>
</body>
</html>
