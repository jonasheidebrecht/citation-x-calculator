<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Citation X Flight Performance Calculators</title>
    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            @apply bg-gray-100 flex flex-col items-center justify-center min-h-screen p-4;
        }
        .calculator-container {
            @apply bg-white p-8 rounded-xl shadow-lg w-full max-w-md my-4;
        }
        label {
            @apply block text-gray-700 text-sm font-bold mb-2;
        }
        input[type="number"] {
            @apply shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline;
        }
        button {
            @apply bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:shadow-outline transition duration-200 ease-in-out transform hover:scale-105;
        }
        .result {
            @apply mt-6 text-center text-lg font-semibold;
        }
        .error-message {
            @apply text-red-600 font-medium mt-4;
        }
        .success-message {
            @apply text-green-600 font-bold;
        }
    </style>
</head>
<body>
    <h1 class="text-3xl font-bold text-gray-900 mb-8">Citation X Performance Calculators</h1>

    <div class="flex flex-wrap justify-center gap-8 w-full">
        <!-- Takeoff Distance Calculator -->
        <div class="calculator-container">
            <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Takeoff Field Length (15° Flaps)</h2>
            <form id="takeoffForm" class="space-y-4">
                <div>
                    <label for="takeoffElevation">Elevation (ft):</label>
                    <input type="number" id="takeoffElevation" value="0" min="0" max="9000" step="1"
                           class="mt-1">
                </div>
                <div>
                    <label for="takeoffTemp">Temperature (°C):</label>
                    <input type="number" id="takeoffTemp" value="15"
                           class="mt-1">
                </div>
                <div>
                    <label for="takeoffWeight">Takeoff Weight (lb):</label>
                    <input type="number" id="takeoffWeight" value="29000" min="25000" max="36100"
                           class="mt-1">
                </div>
                <button type="submit" class="w-full">Calculate Takeoff Distance</button>
            </form>
            <div class="result" id="takeoffResult"></div>
            <div class="error-message hidden" id="takeoffErrorMessage"></div>
        </div>

        <!-- Landing Distance Calculator -->
        <div class="calculator-container">
            <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Landing Distance (Flaps Full)</h2>
            <form id="landingForm" class="space-y-4">
                <div>
                    <label for="landingElevation">Elevation (ft):</label>
                    <input type="number" id="landingElevation" value="0" min="0" max="8000" step="1"
                           class="mt-1">
                </div>
                <div>
                    <label for="landingTemp">Temperature (°C):</label>
                    <input type="number" id="landingTemp" value="15"
                           class="mt-1">
                </div>
                <div>
                    <label for="landingWeight">Landing Weight (lb):</label>
                    <input type="number" id="landingWeight" value="29000" min="23000" max="31800"
                           class="mt-1">
                </div>
                <button type="submit" class="w-full">Calculate Landing Distance</button>
            </form>
            <div class="result" id="landingResult"></div>
            <div class="error-message hidden" id="landingErrorMessage"></div>
        </div>
    </div>

    <script>
        // Helper function: Finds the two bracketing values in a sorted array for a given value.
        // If the value is outside the array, it returns the closest single value twice.
        function bracket(arr, val) {
            // Ensure the array is sorted numerically
            arr = arr.map(Number).sort((a, b) => a - b);
            // If the value is less than or equal to the minimum, clamp to the minimum
            if (val <= arr[0]) return [arr[0], arr[0]];
            // If the value is greater than or equal to the maximum, clamp to the maximum
            if (val >= arr[arr.length - 1]) return [arr[arr.length - 1], arr[arr.length - 1]];
            // Find the two values that bracket the input value
            for (let i = 0; i < arr.length - 1; i++) {
                if (val >= arr[i] && val <= arr[i + 1]) {
                    return [arr[i], arr[i + 1]];
                }
            }
            // Fallback (should not be reached if boundary checks are correct)
            return [arr[0], arr[0]];
        }

        // Helper function for linear interpolation between two points (x0, y0) and (x1, y1)
        // at a given x value.
        function linearInterp(x0, x1, y0, y1, x) {
            if (x0 === x1) return y0; // Avoid division by zero if points are the same
            return y0 + (y1 - y0) * (x - x0) / (x1 - x0);
        }

        /**
         * Performs trilinear interpolation (sequential linear interpolation across three dimensions).
         * @param {object} dataTable - The data table for interpolation.
         * @param {number} elev - The target elevation.
         * @param {number} temp - The target temperature.
         * @param {number} weight - The target weight.
         * @returns {number} The interpolated field length.
         */
        function interpolate(dataTable, elev, temp, weight) {
            // Step 1: Interpolate for weight at an exact elevation and exact temperature.
            function getFieldLengthAtExactET(e, t, w) {
                const weights = Object.keys(dataTable[e][t]).map(Number).sort((a, b) => a - b);
                const [w0, w1] = bracket(weights, w);

                const v0 = dataTable[e][t][w0];
                const v1 = dataTable[e][t][w1];

                return linearInterp(w0, w1, v0, v1, w);
            }

            // Step 2: Interpolate for temperature at an exact elevation and target weight.
            function getFieldLengthAtExactE(e, targetTemp, targetWeight) {
                const temps = Object.keys(dataTable[e]).map(Number).sort((a, b) => a - b);
                const [t0, t1] = bracket(temps, targetTemp);

                const val_t0 = getFieldLengthAtExactET(e, t0, targetWeight);
                const val_t1 = getFieldLengthAtExactET(e, t1, targetWeight);

                return linearInterp(t0, t1, val_t0, val_t1, targetTemp);
            }

            // Step 3: Main interpolation: Interpolate for elevation.
            const elevs = Object.keys(dataTable).map(Number).sort((a, b) => a - b);
            const [e0, e1] = bracket(elevs, elev);

            const val_e0 = getFieldLengthAtExactE(e0, temp, weight);
            const val_e1 = getFieldLengthAtExactE(e1, temp, weight);

            return linearInterp(e0, e1, val_e0, val_e1, elev);
        }

        // Takeoff Data: Elevation (ft) -> Temperature (°C) -> Weight (lb) -> Field Length (ft)
        // All values from pages 7-9 and page 11 of the Citation X Flight Planning Guide (15° flaps)
        const takeoffData = {
            0: {
                0: { 36100: 4890, 35000: 4610, 34000: 4340, 33000: 4080, 31000: 3680, 29000: 3520, 27000: 3440, 25000: 3360 },
                10: { 36100: 5050, 35000: 4760, 34000: 4490, 33000: 4220, 31000: 3800, 29000: 3620, 27000: 3520, 25000: 3440 },
                15: { 36100: 5140, 35000: 4850, 34000: 4560, 33000: 4300, 31000: 3850, 29000: 3670, 27000: 3560, 25000: 3480 },
                20: { 36100: 5230, 35000: 4930, 34000: 4640, 33000: 4370, 31000: 3920, 29000: 3730, 27000: 3600, 25000: 3510 },
                25: { 36100: 5340, 35000: 5030, 34000: 4740, 33000: 4460, 31000: 3990, 29000: 3800, 27000: 3640, 25000: 3550 },
                30: { 36100: 5480, 35000: 5150, 34000: 4850, 33000: 4560, 31000: 4060, 29000: 3870, 27000: 3690, 25000: 3600 },
                35: { 36100: 5910, 35000: 5520, 34000: 5200, 33000: 4890, 31000: 4260, 29000: 3890, 27000: 3710, 25000: 3560 },
                40: { 36100: 6450, 35000: 6000, 34000: 5620, 33000: 5270, 31000: 4580, 29000: 3970, 27000: 3730, 25000: 3530 },
                45: { 34000: 6110, 33000: 5720, 31000: 4950, 29000: 4280, 27000: 3730, 25000: 3540 },
                50: { 31000: 5390, 29000: 4630, 27000: 3990, 25000: 3550 }
            },
            1000: {
                0: { 36100: 5050, 35000: 4760, 34000: 4480, 33000: 4220, 31000: 3800, 29000: 3630, 27000: 3540, 25000: 3460 },
                10: { 36100: 5220, 35000: 4920, 34000: 4640, 33000: 4370, 31000: 3920, 29000: 3730, 27000: 3630, 25000: 3540 },
                15: { 36100: 5310, 35000: 5010, 34000: 4720, 33000: 4440, 31000: 3980, 29000: 3790, 27000: 3670, 25000: 3580 },
                20: { 36100: 5420, 35000: 5100, 34000: 4810, 33000: 4520, 31000: 4050, 29000: 3860, 27000: 3710, 25000: 3620 },
                25: { 36100: 5550, 35000: 5210, 34000: 4910, 33000: 4620, 31000: 4130, 29000: 3930, 27000: 3750, 25000: 3660 },
                30: { 36100: 5930, 35000: 5530, 34000: 5210, 33000: 4900, 31000: 4270, 29000: 3980, 27000: 3780, 25000: 3650 },
                35: { 36100: 6480, 35000: 6030, 34000: 5640, 33000: 5290, 31000: 4600, 29000: 3990, 27000: 3800, 25000: 3600 },
                40: { 35000: 6590, 34000: 6120, 33000: 5730, 31000: 4970, 29000: 4290, 27000: 3810, 25000: 3610 },
                45: { 33000: 6240, 31000: 5390, 29000: 4640, 27000: 4010, 25000: 3630 },
                50: { 31000: 5880, 29000: 5040, 27000: 4330, 25000: 3700 }
            },
            2000: {
                0: { 36100: 5210, 35000: 4920, 34000: 4630, 33000: 4360, 31000: 3930, 29000: 3750, 27000: 3660, 25000: 3570 },
                10: { 36100: 5400, 35000: 5080, 34000: 4790, 33000: 4510, 31000: 4060, 29000: 3860, 27000: 3740, 25000: 3650 },
                15: { 36100: 5510, 35000: 5170, 34000: 4880, 33000: 4590, 31000: 4120, 29000: 3920, 27000: 3780, 25000: 3690 },
                20: { 36100: 5640, 35000: 5280, 34000: 4980, 33000: 4680, 31000: 4200, 29000: 4000, 27000: 3820, 25000: 3730 },
                25: { 36100: 5960, 35000: 5560, 34000: 5220, 33000: 4920, 31000: 4290, 29000: 4050, 27000: 3850, 25000: 3730 },
                30: { 36100: 6500, 35000: 6040, 34000: 5650, 33000: 5300, 31000: 4620, 29000: 4050, 27000: 3870, 25000: 3690 },
                35: { 35000: 6610, 34000: 6140, 33000: 5740, 31000: 4990, 29000: 4310, 27000: 3890, 25000: 3680 },
                40: { 33000: 6250, 31000: 5400, 29000: 4650, 27000: 4020, 25000: 3710 },
                45: { 31000: 5880, 29000: 5040, 27000: 4340, 25000: 3710 },
                50: { 29000: 5490, 27000: 4710, 25000: 4010 }
            },
            3000: {
                "-10": { 36100: 5220, 35000: 4920, 34000: 4640, 33000: 4370, 31000: 3930, 29000: 3750, 27000: 3660, 25000: 3570 },
                0: { 36100: 5410, 35000: 5090, 34000: 4800, 33000: 4510, 31000: 4060, 29000: 3870, 27000: 3770, 25000: 3680 },
                10: { 36100: 5620, 35000: 5260, 34000: 4960, 33000: 4670, 31000: 4190, 29000: 3990, 27000: 3850, 25000: 3760 },
                15: { 36100: 5740, 35000: 5370, 34000: 5060, 33000: 4760, 31000: 4260, 29000: 4060, 27000: 3890, 25000: 3800 },
                20: { 36100: 6000, 35000: 5600, 34000: 5260, 33000: 4950, 31000: 4320, 29000: 4120, 27000: 3910, 25000: 3810 },
                25: { 36100: 6530, 35000: 6080, 34000: 5670, 33000: 5330, 31000: 4640, 29000: 4130, 27000: 3950, 25000: 3770 },
                30: { 35000: 6640, 34000: 6180, 33000: 5770, 31000: 5010, 29000: 4340, 27000: 3970, 25000: 3750 },
                35: { 34000: 6760, 33000: 6260, 31000: 5420, 29000: 4670, 27000: 4040, 25000: 3780 },
                40: { 31000: 5890, 29000: 5060, 27000: 4360, 25000: 3770 },
                45: { 29000: 5500, 27000: 4720, 25000: 4020 }
            },
            4000: {
                "-10": { 36100: 5420, 35000: 5100, 34000: 4800, 33000: 4520, 31000: 4060, 29000: 3870, 27000: 3780, 25000: 3680 },
                0: { 36100: 5630, 35000: 5270, 34000: 4970, 33000: 4680, 31000: 4190, 29000: 3990, 27000: 3880, 25000: 3790 },
                10: { 36100: 5850, 35000: 5460, 34000: 5140, 33000: 4840, 31000: 4330, 29000: 4120, 27000: 3970, 25000: 3870 },
                15: { 36100: 6040, 35000: 5640, 34000: 5290, 33000: 4980, 31000: 4390, 29000: 4190, 27000: 3990, 25000: 3890 },
                20: { 36100: 6580, 35000: 6130, 34000: 5710, 33000: 5360, 31000: 4680, 29000: 4210, 27000: 4010, 25000: 3850 },
                25: { 36100: 7190, 35000: 6680, 34000: 6210, 33000: 5790, 31000: 5040, 29000: 4360, 27000: 4050, 25000: 3820 },
                30: { 34000: 6800, 33000: 6310, 31000: 5450, 29000: 4710, 27000: 4070, 25000: 3850 },
                35: { 31000: 5910, 29000: 5080, 27000: 4380, 25000: 3860 },
                40: { 29000: 5520, 27000: 4750, 25000: 4040 },
                45: { 29000: 6000, 27000: 5130, 25000: 4360 }
            },
            5000: {
                "-10": { 36100: 5610, 35000: 5260, 34000: 4960, 33000: 4670, 31000: 4200, 29000: 4000, 27000: 3900, 25000: 3800 },
                0: { 36100: 5840, 35000: 5450, 34000: 5130, 33000: 4830, 31000: 4340, 29000: 4130, 27000: 4010, 25000: 3910 },
                5: { 36100: 5950, 35000: 5550, 34000: 5210, 33000: 4910, 31000: 4410, 29000: 4200, 27000: 4050, 25000: 3950 },
                10: { 36100: 6120, 35000: 5710, 34000: 5340, 33000: 5030, 31000: 4470, 29000: 4260, 27000: 4080, 25000: 3980 },
                15: { 36100: 6630, 35000: 6170, 34000: 5760, 33000: 5400, 31000: 4710, 29000: 4290, 27000: 4080, 25000: 3930 },
                20: { 36100: 7250, 35000: 6730, 34000: 6260, 33000: 5830, 31000: 5070, 29000: 4400, 27000: 4120, 25000: 3890 },
                25: { 34000: 6830, 33000: 6340, 31000: 5470, 29000: 4730, 27000: 4120, 25000: 3920 },
                30: { 33000: 6930, 31000: 5930, 29000: 5110, 27000: 4410, 25000: 3940 },
                35: { 31000: 6460, 29000: 5530, 27000: 4760, 25000: 4060 },
                40: { 29000: 6020, 27000: 5150, 25000: 4380 }
            },
            6000: {
                "-10": { 36100: 5930, 35000: 5540, 34000: 5210, 33000: 4900, 31000: 4320, 29000: 4120, 27000: 4000, 25000: 3900 },
                0: { 36100: 6170, 35000: 5760, 34000: 5380, 33000: 5070, 31000: 4470, 29000: 4260, 27000: 4110, 25000: 4000 },
                5: { 36100: 6300, 35000: 5870, 34000: 5480, 33000: 5160, 31000: 4540, 29000: 4330, 27000: 4150, 25000: 4050 },
                10: { 36100: 6680, 35000: 6220, 34000: 5800, 33000: 5430, 31000: 4740, 29000: 4380, 27000: 4160, 25000: 4020 },
                15: { 36100: 7310, 35000: 6780, 34000: 6310, 33000: 5870, 31000: 5110, 29000: 4430, 27000: 4190, 25000: 3980 },
                20: { 35000: 7410, 34000: 6870, 33000: 6380, 31000: 5500, 29000: 4760, 27000: 4210, 25000: 3990 },
                25: { 33000: 6940, 31000: 6360, 29000: 5120, 27000: 4420, 25000: 4030 },
                30: { 31000: 6870, 29000: 5470, 27000: 4720, 25000: 4030 },
                35: { 29000: 5870, 27000: 5040, 25000: 4300 },
                40: { 29000: 6320, 27000: 5400, 25000: 4590 }
            },
            7000: {
                "-20": { 36100: 6070, 35000: 5670, 34000: 5320, 33000: 5010, 31000: 4370, 29000: 4100, 27000: 3970, 25000: 3860 },
                "-10": { 36100: 6320, 35000: 5890, 34000: 5500, 33000: 5180, 31000: 4520, 29000: 4250, 27000: 4090, 25000: 3980 },
                0: { 36100: 6580, 35000: 6130, 34000: 5720, 33000: 5360, 31000: 4680, 29000: 4400, 27000: 4200, 25000: 4090 },
                5: { 36100: 6820, 35000: 6350, 34000: 5920, 33000: 5520, 31000: 4830, 29000: 4450, 27000: 4230, 25000: 4100 },
                10: { 36100: 7370, 35000: 6840, 34000: 6360, 33000: 5920, 31000: 5150, 29000: 4470, 27000: 4270, 25000: 4060 },
                15: { 35000: 7410, 34000: 6880, 33000: 6390, 31000: 5510, 29000: 4770, 27000: 4300, 25000: 4070 },
                20: { 34000: 7390, 33000: 6850, 31000: 5860, 29000: 5070, 27000: 4390, 25000: 4110 },
                25: { 33000: 7360, 31000: 6250, 29000: 5390, 27000: 4650, 25000: 4150 },
                30: { 31000: 6700, 29000: 5750, 27000: 4950, 25000: 4230 },
                35: { 29000: 6150, 27000: 5280, 25000: 4500 }
            },
            8000: {
                "-20": { 36100: 6540, 35000: 6090, 34000: 5680, 33000: 5330, 31000: 4660, 29000: 4210, 27000: 4040, 25000: 3940 },
                "-10": { 36100: 6810, 35000: 6330, 34000: 5900, 33000: 5520, 31000: 4820, 29000: 4360, 27000: 4170, 25000: 4060 },
                0: { 36100: 7110, 35000: 6610, 34000: 6160, 33000: 5740, 31000: 5000, 29000: 4500, 27000: 4290, 25000: 4150 },
                5: { 36100: 7530, 35000: 6990, 34000: 6500, 33000: 6050, 31000: 5240, 29000: 4550, 27000: 4340, 25000: 4140 },
                10: { 36100: 8000, 35000: 7410, 34000: 6880, 33000: 6390, 31000: 5510, 29000: 4770, 27000: 4440, 25000: 4150 },
                15: { 35000: 7920, 34000: 7330, 33000: 6800, 31000: 5820, 29000: 5040, 27000: 4430, 25000: 4200 },
                20: { 34000: 7830, 33000: 7240, 31000: 6160, 29000: 5320, 27000: 4600, 25000: 4250 },
                25: { 31000: 6570, 29000: 5650, 27000: 4880, 25000: 4280 },
                30: { 31000: 7060, 29000: 6020, 27000: 5190, 25000: 4430 },
                35: { 29000: 6440, 27000: 5530, 25000: 4710 }
            },
            9000: {
                "-20": { 36100: 7010, 35000: 6520, 34000: 6070, 33000: 5670, 31000: 4940, 29000: 4320, 27000: 4130, 25000: 4020 },
                "-10": { 36100: 7310, 35000: 6790, 34000: 6320, 33000: 5880, 31000: 5120, 29000: 4470, 27000: 4280, 25000: 4140 },
                "-5": { 36100: 7460, 35000: 6930, 34000: 6440, 33000: 5990, 31000: 5200, 29000: 4550, 27000: 4350, 25000: 4190 },
                0: { 36100: 7750, 35000: 7180, 34000: 6680, 33000: 6210, 31000: 5370, 29000: 4660, 27000: 4400, 25000: 4200 },
                5: { 36100: 8230, 35000: 7620, 34000: 7070, 33000: 6570, 31000: 5640, 29000: 4890, 27000: 4460, 25000: 4210 },
                10: { 35000: 8100, 34000: 7500, 33000: 6950, 31000: 5940, 29000: 5140, 27000: 4500, 25000: 4270 },
                15: { 34000: 8000, 33000: 7400, 31000: 6270, 29000: 5420, 27000: 4690, 25000: 4330 },
                20: { 33000: 7920, 31000: 6680, 29000: 5740, 27000: 4950, 25000: 4360 },
                25: { 31000: 7210, 29000: 6140, 27000: 5290, 25000: 4510 },
                30: { 29000: 6600, 27000: 5660, 25000: 4820 }
            }
        };

        // Landing Data: Elevation (ft) -> Temperature (°C) -> Weight (lb) -> Field Length (ft)
        // All values from pages 24-28 of the Citation X Flight Planning Guide (Flaps Full)
        const landingData = {
            0: {
                0: { 31800: 3280, 31000: 3180, 30000: 3070, 28000: 2910, 26000: 2730, 25000: 2650, 24000: 2560, 23000: 2490 },
                10: { 31800: 3360, 31000: 3270, 30000: 3150, 28000: 2980, 26000: 2800, 25000: 2710, 24000: 2620, 23000: 2550 },
                15: { 31800: 3400, 31000: 3310, 30000: 3190, 28000: 3020, 26000: 2840, 25000: 2750, 24000: 2660, 23000: 2580 },
                20: { 31800: 3470, 31000: 3350, 30000: 3230, 28000: 3060, 26000: 2870, 25000: 2780, 24000: 2690, 23000: 2610 },
                25: { 31800: 3530, 31000: 3390, 30000: 3270, 28000: 3100, 26000: 2910, 25000: 2810, 24000: 2720, 23000: 2640 },
                30: { 31800: 3590, 31000: 3430, 30000: 3310, 28000: 3130, 26000: 2940, 25000: 2850, 24000: 2750, 23000: 2670 },
                35: { 31800: 3650, 31000: 3480, 30000: 3350, 28000: 3170, 26000: 2980, 25000: 2880, 24000: 2780, 23000: 2710 },
                40: { 31800: 3720, 31000: 3530, 30000: 3390, 28000: 3210, 26000: 3010, 25000: 2910, 24000: 2820, 23000: 2740 },
                45: { 31800: 3780, 31000: 3590, 30000: 3430, 28000: 3240, 26000: 3040, 25000: 2950, 24000: 2850, 23000: 2770 },
                50: { 31800: 3850, 31000: 3650, 30000: 3470, 28000: 3280, 26000: 3080, 25000: 2980, 24000: 2880, 23000: 2800 }
            },
            1000: {
                0: { 31800: 3360, 31000: 3260, 30000: 3150, 28000: 2980, 26000: 2800, 25000: 2710, 24000: 2620, 23000: 2550 },
                10: { 31800: 3470, 31000: 3350, 30000: 3230, 28000: 3060, 26000: 2870, 25000: 2780, 24000: 2690, 23000: 2610 },
                15: { 31800: 3530, 31000: 3390, 30000: 3270, 28000: 3100, 26000: 2910, 25000: 2810, 24000: 2720, 23000: 2650 },
                20: { 31800: 3590, 31000: 3430, 30000: 3310, 28000: 3130, 26000: 2940, 25000: 2850, 24000: 2750, 23000: 2680 },
                25: { 31800: 3660, 31000: 3480, 30000: 3350, 28000: 3170, 26000: 2980, 25000: 2880, 24000: 2790, 23000: 2710 },
                30: { 31800: 3730, 31000: 3540, 30000: 3390, 28000: 3210, 26000: 3010, 25000: 2920, 24000: 2820, 23000: 2740 },
                35: { 31800: 3800, 31000: 3610, 30000: 3430, 28000: 3250, 26000: 3050, 25000: 2950, 24000: 2850, 23000: 2770 },
                40: { 31800: 3870, 31000: 3670, 30000: 3470, 28000: 3290, 26000: 3090, 25000: 2980, 24000: 2890, 23000: 2800 },
                45: { 31800: 3940, 31000: 3730, 30000: 3510, 28000: 3320, 26000: 3120, 25000: 3020, 24000: 2920, 23000: 2840 },
                50: { 31800: 4010, 31000: 3800, 30000: 3560, 28000: 3360, 26000: 3160, 25000: 3050, 24000: 2950, 23000: 2870 }
            },
            2000: {
                0: { 31800: 3460, 31000: 3350, 30000: 3230, 28000: 3060, 26000: 2870, 25000: 2780, 24000: 2690, 23000: 2600 },
                10: { 31800: 3600, 31000: 3440, 30000: 3310, 28000: 3130, 26000: 2940, 25000: 2850, 24000: 2750, 23000: 2670 },
                15: { 31800: 3660, 31000: 3490, 30000: 3350, 28000: 3170, 26000: 2980, 25000: 2880, 24000: 2790, 23000: 2700 },
                20: { 31800: 3730, 31000: 3550, 30000: 3400, 28000: 3210, 26000: 3020, 25000: 2920, 24000: 2820, 23000: 2730 },
                25: { 31800: 3810, 31000: 3610, 30000: 3440, 28000: 3250, 26000: 3050, 25000: 2950, 24000: 2860, 23000: 2770 },
                30: { 31800: 3880, 31000: 3680, 30000: 3480, 28000: 3290, 26000: 3090, 25000: 2990, 24000: 2890, 23000: 2800 },
                35: { 31800: 3950, 31000: 3740, 30000: 3520, 28000: 3330, 26000: 3130, 25000: 3020, 24000: 2920, 23000: 2830 },
                40: { 31800: 4030, 31000: 3810, 30000: 3570, 28000: 3370, 26000: 3160, 25000: 3060, 24000: 2960, 23000: 2870 },
                45: { 31800: 4110, 31000: 3880, 30000: 3630, 28000: 3410, 26000: 3200, 25000: 3090, 24000: 2990, 23000: 2900 },
                50: { 30000: 3690, 28000: 3450, 26000: 3230, 25000: 3130, 24000: 3020, 23000: 2930 }
            },
            3000: {
                "-10": { 31800: 3460, 31000: 3340, 30000: 3220, 28000: 3050, 26000: 2870, 25000: 2770, 24000: 2680, 23000: 2600 },
                0: { 31800: 3590, 31000: 3430, 30000: 3310, 28000: 3130, 26000: 2940, 25000: 2850, 24000: 2750, 23000: 2670 },
                10: { 31800: 3740, 31000: 3550, 30000: 3400, 28000: 3210, 26000: 3020, 25000: 2920, 24000: 2820, 23000: 2730 },
                15: { 31800: 3810, 31000: 3620, 30000: 3440, 28000: 3250, 26000: 3060, 25000: 2960, 24000: 2860, 23000: 2770 },
                20: { 31800: 3890, 31000: 3680, 30000: 3480, 28000: 3300, 26000: 3090, 25000: 2990, 24000: 2890, 23000: 2800 },
                25: { 31800: 3960, 31000: 3750, 30000: 3530, 28000: 3340, 26000: 3130, 25000: 3030, 24000: 2930, 23000: 2840 },
                30: { 31800: 4040, 31000: 3820, 30000: 3580, 28000: 3380, 26000: 3170, 25000: 3060, 24000: 2960, 23000: 2870 },
                35: { 31800: 4120, 31000: 3890, 30000: 3640, 28000: 3420, 26000: 3210, 25000: 3100, 24000: 3000, 23000: 2900 },
                40: { 31800: 4210, 31000: 3970, 30000: 3710, 28000: 3460, 26000: 3240, 25000: 3140, 24000: 3030, 23000: 2940 },
                45: { 31000: 4040, 30000: 3770, 28000: 3500, 26000: 3280, 25000: 3170, 24000: 3070, 23000: 2970 }
            },
            4000: {
                "-10": { 31800: 3590, 31000: 3430, 30000: 3310, 28000: 3130, 26000: 2940, 25000: 2840, 24000: 2750, 23000: 2660 },
                0: { 31800: 3740, 31000: 3550, 30000: 3400, 28000: 3210, 26000: 3020, 25000: 2920, 24000: 2820, 23000: 2730 },
                10: { 31800: 3890, 31000: 3690, 30000: 3490, 28000: 3300, 26000: 3090, 25000: 2990, 24000: 2890, 23000: 2800 },
                15: { 31800: 3970, 31000: 3760, 30000: 3530, 28000: 3340, 26000: 3130, 25000: 3030, 24000: 2930, 23000: 2840 },
                20: { 31800: 4050, 31000: 3830, 30000: 3590, 28000: 3380, 26000: 3170, 25000: 3070, 24000: 2970, 23000: 2870 },
                25: { 31800: 4140, 31000: 3910, 30000: 3650, 28000: 3420, 26000: 3210, 25000: 3110, 24000: 3000, 23000: 2910 },
                30: { 31800: 4220, 31000: 3980, 30000: 3720, 28000: 3460, 26000: 3250, 25000: 3140, 24000: 3040, 23000: 2940 },
                35: { 31800: 4310, 31000: 4060, 30000: 3780, 28000: 3500, 26000: 3290, 25000: 3180, 24000: 3070, 23000: 2970 },
                40: { 31000: 4140, 30000: 3850, 28000: 3550, 26000: 3330, 25000: 3220, 24000: 3110, 23000: 3010 },
                45: { 28000: 3590, 26000: 3360, 25000: 3250, 24000: 3140, 23000: 3040 }
            },
            5000: {
                "-10": { 31800: 3730, 31000: 3540, 30000: 3390, 28000: 3210, 26000: 3010, 25000: 2910, 24000: 2820, 23000: 2730 },
                0: { 31800: 3890, 31000: 3690, 30000: 3480, 28000: 3300, 26000: 3090, 25000: 2990, 24000: 2890, 23000: 2810 },
                5: { 31800: 3970, 31000: 3760, 30000: 3530, 28000: 3340, 26000: 3130, 25000: 3030, 24000: 2930, 23000: 2840 },
                10: { 31800: 4060, 31000: 3840, 30000: 3590, 28000: 3380, 26000: 3170, 25000: 3070, 24000: 2970, 23000: 2880 },
                15: { 31800: 4140, 31000: 3910, 30000: 3660, 28000: 3430, 26000: 3210, 25000: 3110, 24000: 3000, 23000: 2910 },
                20: { 31800: 4230, 31000: 3990, 30000: 3730, 28000: 3470, 26000: 3250, 25000: 3150, 24000: 3040, 23000: 2950 },
                25: { 31800: 4330, 31000: 4070, 30000: 3800, 28000: 3510, 26000: 3290, 25000: 3190, 24000: 3080, 23000: 2980 },
                30: { 31800: 4420, 31000: 4150, 30000: 3860, 28000: 3550, 26000: 3330, 25000: 3220, 24000: 3110, 23000: 3020 },
                35: { 31800: 4520, 31000: 4240, 30000: 3940, 28000: 3590, 26000: 3370, 25000: 3260, 24000: 3150, 23000: 3050 },
                40: { 30000: 4010, 28000: 3640, 26000: 3410, 25000: 3300, 24000: 3190, 23000: 3090 }
            },
            6000: {
                "-10": { 31800: 3880, 31000: 3680, 30000: 3480, 28000: 3290, 26000: 3090, 25000: 2990, 24000: 2890, 23000: 2790 },
                0: { 31800: 4060, 31000: 3840, 30000: 3590, 28000: 3380, 26000: 3170, 25000: 3070, 24000: 2970, 23000: 2870 },
                5: { 31800: 4150, 31000: 3920, 30000: 3660, 28000: 3430, 26000: 3220, 25000: 3110, 24000: 3000, 23000: 2900 },
                10: { 31800: 4240, 31000: 4000, 30000: 3730, 28000: 3470, 26000: 3260, 25000: 3150, 24000: 3040, 23000: 2940 },
                15: { 31800: 4330, 31000: 4080, 30000: 3800, 28000: 3520, 26000: 3300, 25000: 3190, 24000: 3080, 23000: 2980 },
                20: { 31800: 4430, 31000: 4170, 30000: 3880, 28000: 3560, 26000: 3340, 25000: 3230, 24000: 3120, 23000: 3010 },
                25: { 31800: 4530, 31000: 4250, 30000: 3950, 28000: 3600, 26000: 3380, 25000: 3270, 24000: 3160, 23000: 3050 },
                30: { 31800: 4640, 31000: 4340, 30000: 4030, 28000: 3650, 26000: 3420, 25000: 3310, 24000: 3200, 23000: 3080 },
                35: { 31000: 4430, 30000: 4100, 28000: 3690, 26000: 3460, 25000: 3350, 24000: 3230, 23000: 3120 },
                40: { 30000: 4180, 28000: 3740, 26000: 3500, 25000: 3390, 24000: 3270, 23000: 3160 }
            },
            7000: {
                "-20": { 31800: 3870, 31000: 3670, 30000: 3470, 28000: 3290, 26000: 3080, 25000: 2980, 24000: 2880, 23000: 2790 },
                "-10": { 31800: 4050, 31000: 3830, 30000: 3590, 28000: 3380, 26000: 3170, 25000: 3070, 24000: 2960, 23000: 2860 },
                0: { 31800: 4240, 31000: 4000, 30000: 3730, 28000: 3470, 26000: 3260, 25000: 3150, 24000: 3040, 23000: 2940 },
                5: { 31800: 4340, 31000: 4080, 30000: 3810, 28000: 3520, 26000: 3300, 25000: 3190, 24000: 3080, 23000: 2980 },
                10: { 31800: 4440, 31000: 4170, 30000: 3880, 28000: 3560, 26000: 3340, 25000: 3230, 24000: 3120, 23000: 3010 },
                15: { 31800: 4550, 31000: 4260, 30000: 3960, 28000: 3610, 26000: 3380, 25000: 3270, 24000: 3160, 23000: 3050 },
                20: { 31800: 4650, 31000: 4360, 30000: 4040, 28000: 3650, 26000: 3430, 25000: 3310, 24000: 3200, 23000: 3090 },
                25: { 31800: 4770, 31000: 4450, 30000: 4120, 28000: 3700, 26000: 3470, 25000: 3350, 24000: 3240, 23000: 3130 },
                30: { 31800: 4880, 31000: 4550, 30000: 4200, 28000: 3760, 26000: 3510, 25000: 3390, 24000: 3280, 23000: 3160 },
                35: { 31000: 4650, 30000: 4290, 28000: 3820, 26000: 3550, 25000: 3430, 24000: 3320, 23000: 3200 }
            },
            8000: {
                "-20": { 31800: 4040, 31000: 3820, 30000: 3580, 28000: 3370, 26000: 3170, 25000: 3060, 24000: 2960, 23000: 2860 },
                "-10": { 31800: 4230, 31000: 3990, 30000: 3730, 28000: 3470, 26000: 3250, 25000: 3150, 24000: 3040, 23000: 2940 },
                0: { 31800: 4440, 31000: 4170, 30000: 3890, 28000: 3560, 26000: 3340, 25000: 3230, 24000: 3120, 23000: 3020 },
                5: { 31800: 4550, 31000: 4270, 30000: 3970, 28000: 3610, 26000: 3390, 25000: 3270, 24000: 3160, 23000: 3050 },
                10: { 31800: 4660, 31000: 4370, 30000: 4050, 28000: 3660, 26000: 3430, 25000: 3320, 24000: 3200, 23000: 3090 },
                15: { 31800: 4780, 31000: 4470, 30000: 4130, 28000: 3710, 26000: 3470, 25000: 3360, 24000: 3240, 23000: 3130 },
                20: { 31800: 4900, 31000: 4570, 30000: 4220, 28000: 3770, 26000: 3520, 25000: 3400, 24000: 3280, 23000: 3170 },
                25: { 31800: 5030, 31000: 4670, 30000: 4300, 28000: 3840, 26000: 3560, 25000: 3440, 24000: 3330, 23000: 3210 },
                30: { 31800: 5160, 31000: 4780, 30000: 4390, 28000: 3900, 26000: 3600, 25000: 3480, 24000: 3360, 23000: 3250 },
                35: { 31000: 4890, 30000: 4490, 28000: 3970, 26000: 3650, 25000: 3520, 24000: 3400, 23000: 3280 }
            }
        };


        // Event listener for takeoff form submission
        document.getElementById('takeoffForm').addEventListener('submit', function(e) {
            e.preventDefault(); // Prevent default form submission behavior

            const elev = parseFloat(document.getElementById('takeoffElevation').value);
            const temp = parseFloat(document.getElementById('takeoffTemp').value);
            const weight = parseFloat(document.getElementById('takeoffWeight').value);

            const resultDiv = document.getElementById('takeoffResult');
            const errorDiv = document.getElementById('takeoffErrorMessage');

            // Clear previous results and errors
            resultDiv.innerHTML = '';
            errorDiv.textContent = '';
            errorDiv.classList.add('hidden');

            // Validate inputs against the overall data ranges for takeoff
            const allElevs = Object.keys(takeoffData).map(Number);
            const minElev = Math.min(...allElevs);
            const maxElev = Math.max(...allElevs);

            let allTemps = new Set();
            let allWeights = new Set();
            for (const eKey in takeoffData) {
                for (const tKey in takeoffData[eKey]) {
                    allTemps.add(Number(tKey));
                    for (const wKey in takeoffData[eKey][tKey]) {
                        allWeights.add(Number(wKey));
                    }
                }
            }
            const minTemp = Math.min(...Array.from(allTemps));
            const maxTemp = Math.max(...Array.from(allTemps));
            const minWeight = Math.min(...Array.from(allWeights));
            const maxWeight = Math.max(...Array.from(allWeights));

            if (elev < minElev || elev > maxElev) {
                errorDiv.textContent = `Elevation must be between ${minElev} ft and ${maxElev} ft for takeoff.`;
                errorDiv.classList.remove('hidden');
                return;
            }

            if (temp < minTemp || temp > maxTemp) {
                errorDiv.textContent = `Temperature must be between ${minTemp}°C and ${maxTemp}°C for takeoff.`;
                errorDiv.classList.remove('hidden');
                return;
            }

            if (weight < minWeight || weight > maxWeight) {
                errorDiv.textContent = `Takeoff Weight must be between ${minWeight} lb and ${maxWeight} lb.`;
                errorDiv.classList.remove('hidden');
                return;
            }

            try {
                // Perform interpolation
                const fieldLen = interpolate(takeoffData, elev, temp, weight);
                // Display the result, rounded to nearest whole number
                resultDiv.innerHTML = `<span class="success-message">Estimated Takeoff Field Length: ${fieldLen.toFixed(0)} ft</span>`;
            } catch (error) {
                // Catch any errors during interpolation (e.g., if data structure is unexpected)
                errorDiv.textContent = `An error occurred during calculation. Please check inputs. Details: ${error.message}`;
                errorDiv.classList.remove('hidden');
                console.error("Takeoff Interpolation error:", error);
            }
        });

        // Event listener for landing form submission
        document.getElementById('landingForm').addEventListener('submit', function(e) {
            e.preventDefault(); // Prevent default form submission behavior

            const elev = parseFloat(document.getElementById('landingElevation').value);
            const temp = parseFloat(document.getElementById('landingTemp').value);
            const weight = parseFloat(document.getElementById('landingWeight').value);

            const resultDiv = document.getElementById('landingResult');
            const errorDiv = document.getElementById('landingErrorMessage');

            // Clear previous results and errors
            resultDiv.innerHTML = '';
            errorDiv.textContent = '';
            errorDiv.classList.add('hidden');

            // Validate inputs against the overall data ranges for landing
            const allElevs = Object.keys(landingData).map(Number);
            const minElev = Math.min(...allElevs);
            const maxElev = Math.max(...allElevs);

            let allTemps = new Set();
            let allWeights = new Set();
            for (const eKey in landingData) {
                for (const tKey in landingData[eKey]) {
                    allTemps.add(Number(tKey));
                    for (const wKey in landingData[eKey][tKey]) {
                        allWeights.add(Number(wKey));
                    }
                }
            }
            const minTemp = Math.min(...Array.from(allTemps));
            const maxTemp = Math.max(...Array.from(allTemps));
            const minWeight = Math.min(...Array.from(allWeights));
            const maxWeight = Math.max(...Array.from(allWeights));

            if (elev < minElev || elev > maxElev) {
                errorDiv.textContent = `Elevation must be between ${minElev} ft and ${maxElev} ft for landing.`;
                errorDiv.classList.remove('hidden');
                return;
            }

            if (temp < minTemp || temp > maxTemp) {
                errorDiv.textContent = `Temperature must be between ${minTemp}°C and ${maxTemp}°C for landing.`;
                errorDiv.classList.remove('hidden');
                return;
            }

            if (weight < minWeight || weight > maxWeight) {
                errorDiv.textContent = `Landing Weight must be between ${minWeight} lb and ${maxWeight} lb.`;
                errorDiv.classList.remove('hidden');
                return;
            }

            try {
                // Perform interpolation
                const fieldLen = interpolate(landingData, elev, temp, weight);
                // Display the result, rounded to nearest whole number
                resultDiv.innerHTML = `<span class="success-message">Estimated Landing Distance: ${fieldLen.toFixed(0)} ft</span>`;
            } catch (error) {
                // Catch any errors during interpolation (e.g., if data structure is unexpected)
                errorDiv.textContent = `An error occurred during calculation. Please check inputs. Details: ${error.message}`;
                errorDiv.classList.remove('hidden');
                console.error("Landing Interpolation error:", error);
            }
        });
    </script>
</body>
</html>
