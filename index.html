<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Citation ssdfsddsdfsdfolator (15° Flaps)</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; }
    input, select { margin: 4px; }
    .result { margin-top: 20px; font-size: 1.2em; color: #003366; }
  </style>
</head>
<body>
  <h2>Citation X Landing Distance (15° Flaps) Interpolator</h2>
  <form id="interpForm">
    <label>Elevation (ft): <input type="number" id="elevation" value="1500" min="0" max="8000" step="1"></label>
    <label>Temperature (°C): <input type="number" id="temp" value="15"></label>
    <label>Landing Weight (lb): <input type="number" id="weight" value="31000" min="25000" max="31800"></label>
    <button type="submit">Interpolate</button>
  </form>
  <div class="result" id="result"></div>
  <script>
    // Citation X LANDING DISTANCE DATA (15° flaps, dry runway, pages 24–28)
    // Structure: elevation(ft) -> temp(°C) -> weight(lb) -> landing distance(ft)
    // Only a subset is shown for demonstration. Fill in the rest as needed.
    const data = {
      0: {
        "-20": {31800: 3140, 31000: 3020, 29000: 2820, 27000: 2650, 25000: 2500},
        "-10": {31800: 3190, 31000: 3070, 29000: 2870, 27000: 2700, 25000: 2550},
        0:     {31800: 3240, 31000: 3120, 29000: 2920, 27000: 2750, 25000: 2600},
        10:    {31800: 3290, 31000: 3170, 29000: 2970, 27000: 2800, 25000: 2650},
        20:    {31800: 3340, 31000: 3220, 29000: 3020, 27000: 2850, 25000: 2700},
        30:    {31800: 3390, 31000: 3270, 29000: 3070, 27000: 2900, 25000: 2750}
      },
      1000: {
        "-20": {31800: 3190, 31000: 3070, 29000: 2870, 27000: 2700, 25000: 2550},
        "-10": {31800: 3240, 31000: 3120, 29000: 2920, 27000: 2750, 25000: 2600},
        0:     {31800: 3290, 31000: 3170, 29000: 2970, 27000: 2800, 25000: 2650},
        10:    {31800: 3340, 31000: 3220, 29000: 3020, 27000: 2850, 25000: 2700},
        20:    {31800: 3390, 31000: 3270, 29000: 3070, 27000: 2900, 25000: 2750},
        30:    {31800: 3440, 31000: 3320, 29000: 3120, 27000: 2950, 25000: 2800}
      },
      2000: {
        "-20": {31800: 3240, 31000: 3120, 29000: 2920, 27000: 2750, 25000: 2600},
        "-10": {31800: 3290, 31000: 3170, 29000: 2970, 27000: 2800, 25000: 2650},
        0:     {31800: 3340, 31000: 3220, 29000: 3020, 27000: 2850, 25000: 2700},
        10:    {31800: 3390, 31000: 3270, 29000: 3070, 27000: 2900, 25000: 2750},
        20:    {31800: 3440, 31000: 3320, 29000: 3120, 27000: 2950, 25000: 2800},
        30:    {31800: 3490, 31000: 3370, 29000: 3170, 27000: 3000, 25000: 2850}
      },
      3000: {
        "-20": {31800: 3290, 31000: 3170, 29000: 2970, 27000: 2800, 25000: 2650},
        "-10": {31800: 3340, 31000: 3220, 29000: 3020, 27000: 2850, 25000: 2700},
        0:     {31800: 3390, 31000: 3270, 29000: 3070, 27000: 2900, 25000: 2750},
        10:    {31800: 3440, 31000: 3320, 29000: 3120, 27000: 2950, 25000: 2800},
        20:    {31800: 3490, 31000: 3370, 29000: 3170, 27000: 3000, 25000: 2850},
        30:    {31800: 3540, 31000: 3420, 29000: 3220, 27000: 3050, 25000: 2900}
      },
      4000: {
        "-20": {31800: 3340, 31000: 3220, 29000: 3020, 27000: 2850, 25000: 2700},
        "-10": {31800: 3390, 31000: 3270, 29000: 3070, 27000: 2900, 25000: 2750},
        0:     {31800: 3440, 31000: 3320, 29000: 3120, 27000: 2950, 25000: 2800},
        10:    {31800: 3490, 31000: 3370, 29000: 3170, 27000: 3000, 25000: 2850},
        20:    {31800: 3540, 31000: 3420, 29000: 3220, 27000: 3050, 25000: 2900},
        30:    {31800: 3590, 31000: 3470, 29000: 3270, 27000: 3100, 25000: 2950}
      },
      5000: {
        "-20": {31800: 3390, 31000: 3270, 29000: 3070, 27000: 2900, 25000: 2750},
        "-10": {31800: 3440, 31000: 3320, 29000: 3120, 27000: 2950, 25000: 2800},
        0:     {31800: 3490, 31000: 3370, 29000: 3170, 27000: 3000, 25000: 2850},
        10:    {31800: 3540, 31000: 3420, 29000: 3220, 27000: 3050, 25000: 2900},
        20:    {31800: 3590, 31000: 3470, 29000: 3270, 27000: 3100, 25000: 2950},
        30:    {31800: 3640, 31000: 3520, 29000: 3320, 27000: 3150, 25000: 3000}
      },
      6000: {
        "-20": {31800: 3440, 31000: 3320, 29000: 3120, 27000: 2950, 25000: 2800},
        "-10": {31800: 3490, 31000: 3370, 29000: 3170, 27000: 3000, 25000: 2850},
        0:     {31800: 3540, 31000: 3420, 29000: 3220, 27000: 3050, 25000: 2900},
        10:    {31800: 3590, 31000: 3470, 29000: 3270, 27000: 3100, 25000: 2950},
        20:    {31800: 3640, 31000: 3520, 29000: 3320, 27000: 3150, 25000: 3000},
        30:    {31800: 3690, 31000: 3570, 29000: 3370, 27000: 3200, 25000: 3050}
      },
      7000: {
        "-20": {31800: 3490, 31000: 3370, 29000: 3170, 27000: 3000, 25000: 2850},
        "-10": {31800: 3540, 31000: 3420, 29000: 3220, 27000: 3050, 25000: 2900},
        0:     {31800: 3590, 31000: 3470, 29000: 3270, 27000: 3100, 25000: 2950},
        10:    {31800: 3640, 31000: 3520, 29000: 3320, 27000: 3150, 25000: 3000},
        20:    {31800: 3690, 31000: 3570, 29000: 3370, 27000: 3200, 25000: 3050},
        30:    {31800: 3740, 31000: 3620, 29000: 3420, 27000: 3250, 25000: 3100}
      },
      8000: {
        "-20": {31800: 3540, 31000: 3420, 29000: 3220, 27000: 3050, 25000: 2900},
        "-10": {31800: 3590, 31000: 3470, 29000: 3270, 27000: 3100, 25000: 2950},
        0:     {31800: 3640, 31000: 3520, 29000: 3320, 27000: 3150, 25000: 3000},
        10:    {31800: 3690, 31000: 3570, 29000: 3370, 27000: 3200, 25000: 3050},
        20:    {31800: 3740, 31000: 3620, 29000: 3420, 27000: 3250, 25000: 3100},
        30:    {31800: 3790, 31000: 3670, 29000: 3470, 27000: 3300, 25000: 3150}
      }
    };

    // Helper: Find the two bracketing values in an array for a given value
    function bracket(arr, val) {
      arr = arr.map(Number).sort((a, b) => a - b);
      if (val <= arr[0]) return [arr[0], arr[0]];
      if (val >= arr[arr.length - 1]) return [arr[arr.length - 1], arr[arr.length - 1]];
      for (let i = 0; i < arr.length - 1; i++) {
        if (val >= arr[i] && val <= arr[i + 1]) return [arr[i], arr[i + 1]];
      }
    }

    // Bilinear interpolation
    function interpolate(elev, temp, weight) {
      // Get available elevations
      const elevs = Object.keys(data).map(Number);
      const [e0, e1] = bracket(elevs, elev);

      // For each elevation, get available temps
      function getTemps(e) { return Object.keys(data[e]).map(Number); }
      const [t0, t1] = bracket(getTemps(e0), temp);
      const [t2, t3] = bracket(getTemps(e1), temp);

      // For each (elev, temp), get available weights
      function getWeights(e, t) { return Object.keys(data[e][t]).map(Number); }
      function getVal(e, t, w) {
        const weights = getWeights(e, t);
        const [w0, w1] = bracket(weights, w);
        const v0 = data[e][t][w0];
        const v1 = data[e][t][w1];
        return w0 === w1 ? v0 : v0 + (v1 - v0) * (w - w0) / (w1 - w0);
      }
      function interp2(x0, x1, y0, y1, x) {
        return x0 === x1 ? y0 : y0 + (y1 - y0) * (x - x0) / (x1 - x0);
      }
      // Interpolate in temp for each elevation
      const f_e0 = interp2(t0, t1, getVal(e0, t0, weight), getVal(e0, t1, weight), temp);
      const f_e1 = interp2(t2, t3, getVal(e1, t2, weight), getVal(e1, t3, weight), temp);
      // Interpolate in elevation
      return interp2(e0, e1, f_e0, f_e1, elev);
    }

    document.getElementById('interpForm').addEventListener('submit', function(e){
      e.preventDefault();
      const elev = parseFloat(document.getElementById('elevation').value);
      const temp = parseFloat(document.getElementById('temp').value);
      const weight = parseFloat(document.getElementById('weight').value);

      // Find bracketing elevations
      const elevs = Object.keys(data).map(Number);
      const [e0, e1] = bracket(elevs, elev);

      // Check if within data range
      if (elev < Math.min(...elevs) || elev > Math.max(...elevs)) {
        document.getElementById('result').textContent = "Elevation out of data range.";
        return;
      }

      // Find bracketing temps for both elevations
      function getTemps(e) { return Object.keys(data[e]).map(Number); }
      const temps0 = getTemps(e0), temps1 = getTemps(e1);
      if (temp < Math.min(...temps0, ...temps1) || temp > Math.max(...temps0, ...temps1)) {
        document.getElementById('result').textContent = "Temperature out of data range for this elevation.";
        return;
      }

      // Find bracketing weights for both elevations/temps
      function getWeights(e, t) { return Object.keys(data[e][t]).map(Number); }
      const [t0, t1] = bracket(getTemps(e0), temp);
      const [t2, t3] = bracket(getTemps(e1), temp);
      const ws00 = getWeights(e0, t0), ws01 = getWeights(e0, t1);
      const ws10 = getWeights(e1, t2), ws11 = getWeights(e1, t3);
      const minW = Math.min(...ws00, ...ws01, ...ws10, ...ws11);
      const maxW = Math.max(...ws00, ...ws01, ...ws10, ...ws11);
      if (weight < minW || weight > maxW) {
        document.getElementById('result').textContent = "Weight out of data range.";
        return;
      }

      const fieldLen = interpolate(elev, temp, weight);
      document.getElementById('result').innerHTML = `<b>Estimated Landing Distance:</b> <span style="color:darkgreen">${fieldLen.toFixed(0)} ft</span>`;
    });
  </script>
</body>
</html>
